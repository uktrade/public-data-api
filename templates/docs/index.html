<!doctype html>
<html lang="en" class="govuk-template no-js">
  <head>
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <title>{{ service_name }} - {{ department_name }}</title>
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="{{ service_name }} - {{ department_name }}">
    <meta name="twitter:url" content="{{ url_for('docs', _external=True) }}">
    <meta property="og:site_name" content="{{ service_name }}">
    <meta property="og:title" content="{{ service_name }} - {{ department_name }}">
    <meta property="og:type" content="object">
    <meta property="og:url" content="{{ url_for('docs', _external=True) }}">

    <link href="{{ url_for('static', filename='images/favicon.png') }}" rel="shortcut icon" type="image/png">
    <link rel="canonical" href="{{ url_for('docs', _external=True) }}">
    <link href="{{ url_for('static', filename='docs.css') }}" rel="stylesheet">
  </head>

  <body class="govuk-template__body">
    <script>document.body.className = ((document.body.className) ? document.body.className + ' js-enabled' : 'js-enabled');</script>

    <div class="app-pane">
      <div class="app-pane__header toc-open-disabled">
        <a href="#content" class="govuk-skip-link">Skip to main content</a>

        <header class="govuk-header app-header" role="banner" data-module="govuk-header">
          <div class="govuk-header__container govuk-header__container--full-width">
            <div class="govuk-header__logo">
              <a href="/" class="govuk-header__link govuk-header__link--homepage">
                <span class="govuk-header__logotype">
                  <span class="govuk-header__logotype-text">
                    {{ department_name }}
                  </span>
                </span>
                <span class="govuk-header__product-name">
                  {{ service_name }}
                </span>
              </a>
            </div>
            <div class="govuk-header__content">
              <!-- Placeholder for top level nav -->
            </div>
          </div>
        </header>
      </div>
      <div id="toc-heading" class="toc-show fixedsticky">
        <button type="button" class="toc-show__label js-toc-show" aria-controls="toc">
          Table of contents <span class="toc-show__icon"></span>
        </button>
      </div>
      <div class="app-pane__body" data-module="in-page-navigation">
        <div class="app-pane__toc">
          <div class="toc" data-module="table-of-contents" tabindex="-1" aria-label="Table of contents" role="dialog">
            <button type="button" class="toc__close js-toc-close" aria-controls="toc" aria-label="Hide table of contents"></button>
            <nav id="toc" class="js-toc-list toc__list" aria-labelledby="toc-heading">
              <ul>
                <li>
                  <a href="#top"><span>{{ service_name }}</span></a>
                  <ul>
                    <li>
                      <a href="#base-url"><span>Base URL</span></a>
                    </li>
                    <li>
                      <a href="#concepts"><span>Concepts</span></a>
                    </li>
                    <li>
                      <a href="#common-parameters"><span>Common Parameters</span></a>
                    </li>
                    <li>
                      <a href="#api"><span>API Endpoints</span></a>
                      <ul>
                        <li>
                          <a href="#list-datasets"><span>GET list of datasets</span></a>
                        </li>
                        <li>
                          <a href="#list-versions"><span>GET list of versions of a dataset</span></a>
                        </li>
                        <li>
                          <a href="#list-tables"><span>GET list of tables in a version</span></a>
                        </li>
                        <li>
                          <a href="#get-metadata"><span>GET metadata of a version</span></a>
                        </li>
                        <li>
                          <a href="#get-data"><span>GET data in a version</span></a>
                        </li>
                        <li>
                          <a href="#get-data-table"><span>GET data in a table</span></a>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <a href="#support"><span>Support</span></a>
                    </li>
                    <li>
                      <a href="#security"><span>Security</span></a>
                    </li>
                  </ul>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <div class="app-pane__content toc-open-disabled">
          <main id="content" class="technical-documentation" data-module="anchored-headings">
            <!-- Main title -->
            <h1 id="top">{{ service_name }}</h1>

            <p>The {{ department_name }} {{ service_name }} supplies datasets via <a href="https://en.wikipedia.org/wiki/HTTPS">HTTPS</a>.</p>
            <ul>
              <li>Datasets are versioned</li>
              <li>Each dataset version is immutable</li>
              <li>Metadata for each dataset version is available as <a href="https://en.wikipedia.org/wiki/HTML">HTML</a> or <a href="https://www.w3.org/TR/tabular-data-primer/">CSVW</a> (CSV on the Web)</li>
              <li>Columns and rows can be filtered using the <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/s3-glacier-select-sql-reference-select.html">S3 Select query language</a></li>
              <li>Data is supplied as <a href="https://en.wikipedia.org/wiki/JSON">JSON</a> or <a href="https://www.gov.uk/government/publications/recommended-open-standards-for-government/tabular-data-standard">CSV</a></li>
              <li>Authentication is not required</li>
            </ul>

            <p>The source code for the {{ service_name }} is available in its <a href="{{ github_repo_url }}">GitHub repository</a>.</p>

            <h2 id="base-url">Base URL</h2>
            <p>All requests to this API should be prefixed with the following URL:</p>
            <p><strong>{{ base_url }}</strong></p>

            <!-- API -->
            <h2 id="concepts">Concepts</h2>
            <p>The function of the {{ service_name }} is to supply datasets. A dataset has one or more immutable versions, and each version has one or more tables.<p>

            <p>All the data in a version can be accessed by the <a href="#get-data">GET data in a version</a> endpoint, or the data in a single table of a version can be access by the <a href="#get-data-table">GET data in a table</a> endpoint.</p>

            <h2 id="common-parameters">Common parameters</h2>

            <p>Several parameters are applicable to multiple API endpoints.</p>

            <table class="govuk-table">
              <thead class="govuk-table__head">
                <tr class="govuk-table__row">
                  <th scope="col" class="govuk-table__header govuk-!-width-one-quarter">Name</th>
                  <th scope="col" class="govuk-table__header">Description</th>
                </tr>
              </thead>
              <tbody class="govuk-table__body">
                <tr class="govuk-table__row">
                  <td scope="row" class="govuk-table__cell"><code class="hljs html">dataset</code></td>
                  <td class="govuk-table__cell">A human-readable identifier of the dataset, e.g. <code>{{ dataset }}</code></td>
                </tr>
                <tr class="govuk-table__row">
                  <td scope="row" class="govuk-table__cell"><code class="hljs html">version</code></td>
                  <td class="govuk-table__cell">
                      <p>A version in the format <code class="hljs html">vX.Y.Z</code>, where <code class="hljs html">X.Y.Z</code> is the <a href="https://semver.org/">Semver 2.0</a> version of the dataset, e.g. <code>{{ version }}</code></p>
                      <p>or</p>
                      <p>A version in the format <code class="hljs html">vX.Y</code>. In this case, a HTTP 302 redirect is returned to the original URL requested, but with <code class="hljs html">version</code> replaced with the latest <code class="hljs html">vX.Y</code> version of the dataset</p>
                      <p>or</p>
                      <p>A version in the format <code class="hljs html">vX</code>. In this case, a 302 redirect is returned to the original URL requested, but with <code class="hljs html">version</code> replaced with the latest <code class="hljs html">vX</code> version of the dataset</p>
                      <p>or</p>
                      <p>The literal <code class="hljs html">latest</code>. In this case, a 302 redirect is returned to the original URL requested, but with <code class="hljs html">version</code> replaced with the latest version of the dataset</p>
                  </td>
                </tr>
                <tr class="govuk-table__row">
                  <td scope="row" class="govuk-table__cell"><code class="hljs html">table</code></td>
                  <td class="govuk-table__cell">A human-readable table name, e.g. <code>{{ table_name }}</code></td>
                </tr>
              </tbody>
            </table>

            <h2 id="api">API Endpoints</h2>

            <h3 id="list-datasets">GET list of datasets</h3>
            <pre><code class="hljs html">GET /v1/datasets</code></pre>
            <h4 id="list-datasets-query-string-parameters">Query string parameters</h4>
            <table class="govuk-table">
              <thead class="govuk-table__head">
                <tr class="govuk-table__row">
                  <th scope="col" class="govuk-table__header govuk-!-width-one-quarter">Name</th>
                  <th scope="col" class="govuk-table__header">Description</th>
                </tr>
              </thead>
              <tbody class="govuk-table__body">
                <tr class="govuk-table__row">
                  <td scope="row" class="govuk-table__cell"><code class="hljs html">format</code> (required)</td>
                  <td class="govuk-table__cell">The requested output format. In all cases, this must be <code class="hljs html">json</code></td>
                </tr>
              </tbody>
            </table>
            <h4 id="list-datasets-example">Example</h4>
            <h5 id="list-datasets-example-request">Request</h5>
            <pre><code class="hljs html">curl --get {{ base_url }}/v1/datasets \
    --data-urlencode "format=json"</code></pre>
            <h5 id="list-datasets-example-response">Response</h5>
            <pre><code class="hljs html">Status: 200 OK
{
    "datasets": [
        {"id": "market-barriers"}, {"id": "uk-tariff-2021-01-01"}
    ]
}</code></pre>

            <h3 id="list-versions">GET list of versions of a dataset</h3>
            <pre><code class="hljs html">GET /v1/datasets/:dataset/versions</code></pre>
            <h4 id="list-versions-query-string-parameters">Query string parameters</h4>
            <table class="govuk-table">
              <thead class="govuk-table__head">
                <tr class="govuk-table__row">
                  <th scope="col" class="govuk-table__header govuk-!-width-one-quarter">Name</th>
                  <th scope="col" class="govuk-table__header">Description</th>
                </tr>
              </thead>
              <tbody class="govuk-table__body">
                <tr class="govuk-table__row">
                  <td scope="row" class="govuk-table__cell"><code class="hljs html">format</code> (required)</td>
                  <td class="govuk-table__cell">The requested output format. In all cases, this must be <code class="hljs html">json</code></td>
                </tr>
              </tbody>
            </table>
            <h4 id="list-versions-example">Example</h4>
            <h5 id="list-versions-example-request">Request</h5>
            <pre><code class="hljs html">curl --get {{ base_url }}/v1/datasets/{{ dataset }}/versions \
    --data-urlencode "format=json"</code></pre>
            <h5 id="list-versions-example-response">Response</h5>
            <pre><code class="hljs html">Status: 200 OK
{
    "versions": [
        {"id": "{{ latest_version }}"}, {"id": "{{ version }}"}
    ]
}</code></pre>

            <h3 id="list-tables">GET list of tables in a version</h3>
            <pre><code class="hljs html">GET /v1/datasets/:dataset/versions/:version/tables</code></pre>
            <h4 id="list-tables-query-string-parameters">Query string parameters</h4>
            <table class="govuk-table">
              <thead class="govuk-table__head">
                <tr class="govuk-table__row">
                  <th scope="col" class="govuk-table__header govuk-!-width-one-quarter">Name</th>
                  <th scope="col" class="govuk-table__header">Description</th>
                </tr>
              </thead>
              <tbody class="govuk-table__body">
                <tr class="govuk-table__row">
                  <td scope="row" class="govuk-table__cell"><code class="hljs html">format</code> (required)</td>
                  <td class="govuk-table__cell">The requested output format. In all cases, this must be <code class="hljs html">json</code></td>
                </tr>
              </tbody>
            </table>
            <h4 id="list-tables-version-example">Example for specific version</h4>
            <h5 id="list-tables-example-request">Request</h5>
            <pre><code class="hljs html">curl --get {{ base_url }}/v1/datasets/{{ dataset }}/versions/{{ version }}/tables \
    --data-urlencode "format=json"</code></pre>
            <h5 id="list-tables-example-response">Response</h5>
            <pre><code class="hljs html">Status: 200 OK
{
    "tables": [
        {"id": "commodities"},
        {"id": "measures-as-defined"},
        {"id": "measures-on-declarable-commodities"}
    ]
}</code></pre>
            <h4 id="list-tables-latest-version-example">Example for latest version</h4>
            <p>Replacing the version string with the word <code>latest</code> will result in a redirect to the latest version of the dataset.</p>
            <h5 id="list-tables-latest-version-example-request">Request</h5>
            <pre><code class="hljs html">curl --get {{ base_url }}/v1/datasets/{{ dataset }}/versions/latest/tables
    --data-urlencode "format=json"</code></pre>
            <h5 id="list-tables-latest-version-example-response">Response</h5>
            <pre><code class="hljs html">Status: 302 Found
Location: /v1/datasets/{{ dataset }}/versions/{{ latest_version }}/tables?format=json</code></pre>

            <h3 id="get-metadata">GET metadata of a version</h3>
            <p>The metadata of a dataset version can be accessed using this endpoint.</p>
            <pre><code class="hljs html">GET /v1/datasets/:dataset/versions/:version/metadata</code></pre>
            <h4 id="get-metadata-query-string-parameters">Query string parameters</h4>
            <table class="govuk-table">
              <thead class="govuk-table__head">
                <tr class="govuk-table__row">
                  <th scope="col" class="govuk-table__header govuk-!-width-one-quarter">Name</th>
                  <th scope="col" class="govuk-table__header">Description</th>
                </tr>
              </thead>
              <tbody class="govuk-table__body">
                <tr class="govuk-table__row">
                  <td scope="row" class="govuk-table__cell"><code class="hljs html">format</code> (required)</td>
                  <td class="govuk-table__cell">The requested output format. This must be <code class="hljs html">csvw</code> or <code class="hljs html">html</code></td>
                </tr>
                <tr class="govuk-table__row">
                  <td scope="row" class="govuk-table__cell"><code class="hljs html">download</code> (optional)</td>
                  <td class="govuk-table__cell">The presence of this parameter results in a <code class="hljs html">content-disposition</code> header so that browsers attempt to download the metadata rather than display it inline</td>
                </tr>
              </tbody>
            </table>
            <h4 id="get-metadata-csvw-example">Example requesting CSVW</h4>
            <h5 id="get-metadata-csvw-example-request">Request</h5>
            <pre><code class="hljs html">curl --get {{ base_url }}/v1/datasets/{{ dataset }}/versions/{{ version }}/metadata \
    --data-urlencode "format=csvw"</code></pre>
            <h5 id="get-metadata-csvw-example-response">Response (excerpt)</h5>
            <pre><code class="hljs html">Status: 200 OK
{
  "@context": [
    "http://www.w3.org/ns/csvw",
    {"dit": "http://data.api.trade.gov.uk/"}
  ],
  "dc:title": "Tariffs to trade with the UK from 1 January 2021",
  ...
  "tables": [{
    "id": "commodities",
    ...
    "tableSchema": {
      "columns": [{
        "name": "id",
        ...
      }, ...]
    }
  }, ...]
}</code></pre>

            <h3 id="get-data">GET data in a version</h3>
            <p>Entire data of a version of the dataset can be accessed/downloaded using this endpoint</p>
            <pre><code class="hljs html">GET /v1/datasets/:dataset/versions/:version/data</code></pre>
            <h4 id="get-specific-version-query-string-parameters">Query string parameters</h4>
            <table class="govuk-table">
              <thead class="govuk-table__head">
                <tr class="govuk-table__row">
                  <th scope="col" class="govuk-table__header govuk-!-width-one-quarter">Name</th>
                  <th scope="col" class="govuk-table__header">Description</th>
                </tr>
              </thead>
              <tbody class="govuk-table__body">
                <tr class="govuk-table__row">
                  <td scope="row" class="govuk-table__cell"><code class="hljs html">format</code> (required)</td>
                  <td class="govuk-table__cell">The requested output format. In all cases, this must be <code class="hljs html">json</code></td>
                </tr>
                <tr class="govuk-table__row">
                  <td scope="row" class="govuk-table__cell"><code class="hljs html">query-s3-select</code> (optional)</td>
                  <td class="govuk-table__cell">A query using the <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/s3-glacier-select-sql-reference-select.html">S3 Select query language</a>. If specified, the response is a JSON object with results under the <code class="hljs html">rows</code> key, i.e. <code class="hljs html">{"rows": [...]}</code>,
                  e.g. <code class="hljs psql">SELECT * FROM S3Object[*]</code></td>
                </tr>
                <tr class="govuk-table__row">
                  <td scope="row" class="govuk-table__cell"><code class="hljs html">download</code> (optional)</td>
                  <td class="govuk-table__cell">The presence of this parameter results in a <code class="hljs html">content-disposition</code> header so that browsers attempt to download the data rather than display it inline.</td>
                </tr>
              </tbody>
            </table>
            <h4 id="get-specific-version-range-requests">Range requests</h4>
            <p>If a <code class="hljs html">query-s3-select</code> is <i>not</i> specified, the <code class="hljs html">range</code> HTTP header can be passed to select a byte-range of the dataset. See <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Range_requests">HTTP Range Requests</a> for more details.</p>
            <h4 id="get-specific-version-example-without-query">Example without a query</h4>
            <h5 id="get-specific-version-example-without-query-request">Request</h5>
            <pre><code class="hljs html">curl --get {{ base_url }}/v1/datasets/{{ dataset }}/versions/{{ version }}/data \
    --data-urlencode "format=json"</code></pre>
            <h5 id="get-specific-version-example-without-a-query-response">Response (excerpt)</h5>
            <pre><code class="hljs html">Status: 200 OK
{
    "commodities": [
        {"id": "1", "commodity__code": "0100000000", ...
        ...
    ],
    ...
}</code></pre>
            <h4 id="get-specific-version-example-with-query">Example with a query</h4>
            <h5 id="get-specific-version-example-with-request">Request</h5>
            <pre><code class="hljs html">curl --get https://data.api.trade.gov.uk/v1/datasets/uk-tariff-2021-01-01/versions/v2.1.0/data \
    --data-urlencode "format=json" \
    --data-urlencode "query-s3-select=
        SELECT
            c.commodity__code, c.commodity__suffix, c.commodity__description
        FROM
            S3Object[*].commodities[*] c
        WHERE
            c.commodity__code = '0101210000'
        LIMIT
            1
    "</code></pre>
            <h5 id="get-specific-version-example-with-query-response">Response</h5>
            <pre><code class="hljs html">Status: 200 OK
{
    "rows":[
      {"commodity__code": "0101210000", "commodity__suffix": "10", "commodity__description": "Horses"}
    ]
}</code></pre>
            <h4 id="get-latest-version-example">Example for latest data</h4>
            <h5 id="get-latest-version-example-request">Request</h5>
            <p>Replacing the version string with the word <code>latest</code> will result in a redirect to the latest version of the dataset.</p>
            <pre><code class="hljs html">curl --get {{ base_url }}/v1/datasets/{{ dataset }}/versions/latest/data \
    --data-urlencode "format=json"</code></pre>
            <h5 id="get-latest-version-example-response">Response</h5>
            <pre><code class="hljs html">Status: 302 Found
Location: /v1/datasets/{{ dataset }}/versions/{{ latest_version }}/data?format=json</code></pre>

            <h3 id="get-data-table">GET data in a table</h3>
            <p>A version of the dataset can have one or more tables. Each table can be accessed/downloaded using this endpoint</p>
            <pre><code class="hljs html">GET /v1/datasets/:dataset/versions/:version/tables/:table/data</code></pre>
            <h4 id="get-data-table-query-string-parameters">Query string parameters</h4>
            <table class="govuk-table">
              <thead class="govuk-table__head">
                <tr class="govuk-table__row">
                  <th scope="col" class="govuk-table__header govuk-!-width-one-quarter">Name</th>
                  <th scope="col" class="govuk-table__header">Description</th>
                </tr>
              </thead>
              <tbody class="govuk-table__body">
                <tr class="govuk-table__row">
                  <td scope="row" class="govuk-table__cell"><code class="hljs html">format</code> (required)</td>
                  <td class="govuk-table__cell">The requested output format. In all cases, this must be <code class="hljs html">csv</code></td>
                </tr>
                <tr class="govuk-table__row">
                  <td scope="row" class="govuk-table__cell"><code class="hljs html">download</code> (optional)</td>
                  <td class="govuk-table__cell">The presence of this parameter results in a <code class="hljs html">content-disposition</code> header so that browsers attempt to download the data rather than display it inline.</td>
                </tr>
              </tbody>
            </table>
            <h4 id="get-data-table-example-version">Example</h4>
            <h5 id="get-data-table-example-version-request">Request</h5>
            <pre><code class="hljs html">curl --get {{ base_url }}/v1/datasets/{{ dataset }}/versions/{{ version }}/tables/{{ table_name }}/data \
    --data-urlencode "format=csv"</code></pre>
            <h5 id="get-data-table-example-version-response">Response</h5>
            <pre><code class="hljs html">Status: 200 OK
"id","commodity__sid","commodity__code","commodity__suffix","commodity__description","commodity__validity_start","commodity__validity_end","parent__sid","parent__code","parent__suffix"
"1","27623","0100000000","80","LIVE ANIMALS","1971-12-31","#NA","#NA","#NA","#NA"
"2","27624","0101000000","80","Live horses, asses, mules and hinnies","1972-01-01","#NA","27623","0100000000","80"
"3","93797","0101210000","10","Horses","2012-01-01","#NA","27624","0101000000","80"
</code></pre>
            <h4 id="get-data-table-example-latest">Example with latest</h4>
            <p>Replacing the version string with the word <code>latest</code> will result in a redirect to the latest version of the dataset.</p>
            <h5 id="get-data-table-example-latest-request">Request</h5>
            <pre><code class="hljs html">curl --get {{ base_url }}/v1/datasets/{{ dataset }}/versions/latest/tables/{{ table_name }}/data
    --data-urlencode "format=csv"</code></pre>
            <h5 id="get-data-table-example-latest-response">Response</h5>
            <pre><code class="hljs html">Status: 302 Found
Location: /v1/datasets/{{ dataset }}/versions/{{ latest_version }}/tables/{{ table_name }}/data?format=csv</code></pre>

            <h2 id="support">Support</h2>

            <p>For help with the {{ service_name }} please create an issue on its <a href="{{ github_repo_url }}/issues">GitHub issues page</a>.</p>

            <h2 id="security">Security</h2>

            <p>To report a security vulnerability please contact us at <a href="mailto:{{ security_email }}">{{ security_email }}</a>.</p>

          </main>
          <footer class="govuk-footer app-footer" role="contentinfo">
            <div class="govuk-footer__meta">
              <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">
                <svg
                  aria-hidden="true"
                  focusable="false"
                  class="govuk-footer__licence-logo"
                  xmlns="http://www.w3.org/2000/svg"
                  viewbox="0 0 483.2 195.7"
                  height="17"
                  width="41"
                >
                  <path
                    fill="currentColor"
                    d="M421.5 142.8V.1l-50.7 32.3v161.1h112.4v-50.7zm-122.3-9.6A47.12 47.12 0 0 1 221 97.8c0-26 21.1-47.1 47.1-47.1 16.7 0 31.4 8.7 39.7 21.8l42.7-27.2A97.63 97.63 0 0 0 268.1 0c-36.5 0-68.3 20.1-85.1 49.7A98 98 0 0 0 97.8 0C43.9 0 0 43.9 0 97.8s43.9 97.8 97.8 97.8c36.5 0 68.3-20.1 85.1-49.7a97.76 97.76 0 0 0 149.6 25.4l19.4 22.2h3v-87.8h-80l24.3 27.5zM97.8 145c-26 0-47.1-21.1-47.1-47.1s21.1-47.1 47.1-47.1 47.2 21 47.2 47S123.8 145 97.8 145"
                  >
                </svg>
                <span class="govuk-footer__licence-description">
                  All content is available under the
                  <a
                    class="govuk-footer__link"
                    href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
                    rel="license"
                  >Open Government Licence v3.0</a>, except where otherwise stated
                </span>
              </div>
              <div class="govuk-footer__meta-item">
                <a
                  class="govuk-footer__link govuk-footer__copyright-logo"
                  href="https://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/uk-government-licensing-framework/crown-copyright/"
                >Â© Crown copyright</a>
              </div>
            </div>
          </footer>
        </div>
      </div>
    </div>
    <script src="{{ url_for('static', filename='docs.js') }}"></script>
  </body>
</html>
